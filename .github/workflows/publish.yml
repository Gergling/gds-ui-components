name: 'Autopublish'

on:
  push:
    tags:
      - 'v[0-9]+.[0-9]+.[0-9]+'

jobs:
  autopublish:
    name: Publish release when tagged
    runs-on: ubuntu-22.04
    steps:
      - name: Check out repository
        uses: actions/checkout@v2

      - name: Check package version
        id: cpv
        uses: PostHog/check-package-version@v2
        with:
          path: ui-components

      - name: Echo output
        run: |
          echo "Committed version: ${{ steps.cpv.outputs.committed-version }}"
          echo "Published version: ${{ steps.cpv.outputs.published-version }}"
          echo "Is new version: ${{ steps.cpv.outputs.is-new-version }}"
          
      # - name: get-npm-version
      #   id: package-version
      #   uses: martinbeentjes/npm-get-version-action@v1.3.1
      #   with:
      #     path: ui-components

      # - name: Echo versions
      #   run: |
      #     echo "Package version: ${{ steps.package-version.outputs.current-version}}"

      # - name: Install dependencies
      #   if: steps.cpv.outputs.is-new-version == 'true'
      #   run: npm ci

      # - name: Publish new version
      #   if: steps.cpv.outputs.is-new-version == 'true'
      #   run: npm publish
